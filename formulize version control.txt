BUGS needing attention:
--when you rename a caption, existing entries don't use that caption (form_form not updated, apostrophes will have to be replaced as per the normal writing routine when this happens)
--all fields need to be made required
--Formid not present in form_menu table, and menu and forms can get out of sync causing forms to not be displayed in the menu.  Solutions: add formid to form_menu table and use that instead of menuid, or enforce synching when creating new records, or change the way mymenu.php reads things.
--can't clear/blank a date field
--view form page (main page) does not have alignment with the corner for some reason!! Mozilla bug?  Does not happen in IE 5.
--Don't have permission to access form permissions unless admin?  Shouldn't it work off of Form module admin permission?
--view page not working if no headerlist specified (graceful degradation to required fields is not working).
--Caption validation should be part of onsubmit function, not onChange with field
--Many default values not showing up on creating form page (only text boxes show?).
--anon users have strange behaviour in single forms:  no-single/no-group:  can see anon submitted entries in list.  no-single/group:  can see entries by registered users in anon group, but not actual anon entries.  single/no-group, they see the first anon entry. single/group, they see first entry by registered user in anon group if one exists, otherwise they don't see an anon entry.
--date boxes don't show proper default value when redisplayed on editing that element in the form builder.
--quasi-bug: add permission doesn't "come with" view permission.  Make view filters look for add too.
--default values of radio buttons (yn buttons too) are lost after a resorting of elements
--changing the sort order of elements after selecting the headerlist causes problems in displaying entries since the order of headers in the headerlist and the actual order of the form elements won't match. (Workaround, reselect headerlist after resorting elements)
--queries with a local OR fail if any of the query terms are not part of the target set anywhere (a,b,c search is LIKE a or z, no returns, when a should be returned).  Verified to exist with equal operator as well as like, probably others.
--when a form is deleted, it's permissions aren't deleted
--sorting elements in a form removes links in select boxes

NOTES:
--Not backwards compatible with Formulaire. 
--having multiple groups able to access a groupscope form can lead to strange results (different users who aren't all members of the same groups will may see different records; changing which groups have permission after the form has been used may change the record that is displayed for a group)!!!
--No handling of existing File upload entries for viewing or editing
--can't use \ or " in a caption or Form name.
--new language entries have not been translated, but english entries are present in language files right now.
--linked select boxes do not pass entry name to the mail template, only the id numbers sent back from the form
--implicit OR used for multi field queries
--Secondary, tertiary, etc sorting options behave badly if they are on number fields.  
--note that the form configuration means that if the user has typed in the report name box, then if they *do a query with the ENTER key* the report will be saved. -- not sure, depends on whether scope is visible I think since scope comes before saving in options.
--a user can leave a group and in so doing possibly restrict other users from seeing entries they made while a member of that group (since the viewentry check looks for overlap in group membership of entry owner and current user). 
--be observant about entries in groupscope forms appearing to belong to the correct user.  There should be no problem, but the records and the metadata are generated separately so it is technically possible for them to be out of sync.
--linked selectboxes are meant to be linked to textboxes.  Linking to fixed option elements in other forms can lead to strangeness, esp if the other element allows multiple selections.
--strange things can happen with linked selections users have made if the underlying data changes.  One thing:  selected items will show up on the summary list, but when you edit the entries, the items won't show up since the underlying link data has changed, which is probably accurate, but strange.
--If a term in the DB contains trailing or leading spaces (the user pressed spacebar before typing their name, for example), then you have to mimic the exact spacing around the term to get a match on searches.
--scope box shows up for:  admins and nonadmins when viewing a non-scopelocked report for a groupscope form, and when in reportwritingmode on a groupscope form.  Admins also get it for single-entry forms.  Module admins have the scope box expand, when visible, to show all groups.


TODO:
***current:
F-default to view entries page for single-nongroupscope forms where the user has an entry already, and the user is an admin (so they can see other user's entries).
1-Remove Formulaire options in form creation and editing and main menu that are no longer used.
1-FIX BUG WITH RESORTING SO THAT IT ONLY REWRITES THE POSITION ENTRY FOR EACH FIELD, not the whole field's data
1-add another reporting option (and must increase published type to int), so that you can force the scopebox on single forms so that noadmin users can still break the scope.  This would let regular volunteers (non form admins) be able to view interests/expertise report (non-scopelocked type of report) for a single entry form and still be able to break out of their single scope.
1-add ability to publish reports to users
1-THIS IS SOLVED IF YOU HAVE A REPORTING OPTION THAT ALLOWS THE REPORT TO COME WITH GROUPSCOPE.  improve report writing so that you can publish the same report to a whole bunch of groups with a locked scope for each group, so you don't have to repeat the publishing process 20 times!  (This is necessitated by not wanting to make users choose the scope for the report, and the fact that regular users (volunteers) won't have a scope selection anyway, since their default scope will be themselves.)
2-delete all option on summary page
1-fix big registerform hack where we hardcode in the translations, and language hack in register.php too for account activation error message
2-calendar starts on sunday?!
1-build in notifications when reports are "updated" (underlying data changes), when entries are made, etc.
1-alter writing of stuff to screen so that it doesn't use the text sanitizer, that should fix the e-mail problem and the br problem in text areas.

***general
?-can sorting be switched to multi-sort since you can't pick multiple columns as a sort key? and how are single links handled?  Since they might be treated as alphabetical right now?
F-change form creation so that order value auto-increments by 5 for each new element (and increase the size of the order field in the DB to int)
F-allow users to specify that a certain form should be the initial/default view for a form, and change the View Report label to "Currently Viewing:" and change the "default view" label to General, or generic, or something else (since it might not be the default any more).
1-alter the form_form table to use a key instead of the caption.
F-complex links, where you specify the SQL, or by some other method, what info is supposed to show up there (ie: all activities entered by a volunteer appear on the tracking page)
4-forms can use custom "thanks your info has been received" messages.  Useful for volunteer application.
F-make sure line breaks is default config setting for checkbox/radio button delimiter
2-add way for entries of deleted users to be deleted.
1-use shortened versions of the captions for the column headers
3-Somehow, add scope to delete button on view entries page, (break out array into elements to pass as hidden?) so scope isn't lost on delete
6-delete permissions for a form when the form is deleted (right now this is just leaving flotsam and jetsam in the DB).
4-copy form feature (number of copies, specify names, record the original form name, possibly a slave feature where changes to the master form affected all copies??...)
5-add logic to respond to max entries param.
F-make validation of registration page all javascript based, so bad data is not entered
6-complete docs and/or add 'help' info to the add/update form page to explain some options (with standard templates? javascript to enable different options?)
F-add ability to export forms for installing in other XOOPS installations
F-add in required field for all elements
F-add rename box back into formupdate page
F-add ability to chain forms together (redirect_header points to the next URL)
F-on deletion of a form, remove reports for that form
***form creation:
2-add custom messages on submit of forms (application form:  Thanks, a coordinator will contact you shortly).
F-make upload elements work (for Actua?)
3-specify categories the form is in on creation
F-remove <h5> from captions after adding options with the "tray"
F-add ability to remove defaults from radio buttons in edit-form-elements page.
F-move form settings (multiple, view entires, etc) to be group-based settings, rather than settings attached to the form.
F-make radio/checkbox delimiter a form option instead of a global preference
***permissions:
F-separate add and edit permissions, so local volunteer groups can edit entries but not make new ones.
F-implement administration permissions logic in admin area so that users can only see forms they are allowed to see on the administration side of things (for changing elements, changing permissions, etc) 
***display/navigation:
2-change order of columns on report screens
2-shorten column names on report screens (or make a way to enter alternative short text for each field)
2-add ability to sort by any column on the regular report screen
3-add 'category' ability to group forms in the menu system -- expansion of mymenu functionality in formulaire (Downloads has submenus, so borrow that technique)
6-add link on form creation page back to main form admin page
4-put link on form perm page back to main admin page.
4-put link on form element adding page to go to form setting page to specify header rows
5-change back link after changing perms (not main index, but back to the formindex.php?permform)
F-shorten field names in _select template for headers
***reporting features:
F-Special sort option to sort by last name in a name field?
F-alterative to special last name sort: specify links differently, so displayed info for a link can be an amalgam of info in the linked form.
3-export calculations as well as data
3-add in ability to date fields to be queried against the current date.
2-add in a between operator for searches
2-add ability to modify (update/overwrite) existing reports.
F-add in logic to cull old export files when new files are created.
F-add ability to specify that calculations occur over the entire universe of entries?  Requires two queries since you'd be calculating over something other than the selvals array.
F-add new count calculation: number of entries per user. Related to following....add "for each" option to calculations, so they can be applied not just to the entire results, but to each subset of the results that matches a criteria (entered by each user, or has a unique field, such as volunteer name, in another part of the form), PERHAPS JUST FOR PERCENTAGES?
F-ability to save completely static reports (snapshots) by storing template output in the DB?
F-add way of searching for blanks?
F-add way of searching related to dates of entries (not sure on this.  User searches occur by setting scopes.
F-add in way of including data from a linked form in a report.  Searches and sorts, etc, would still be only on the primary form, but the displayed entries would include data from the target of the link (ie: address info in vol-ed matching form).
F-add in reporting ability to report across similar forms, so you could group together entries with different id_forms, and thereby make a national list out of a series of local forms.  However this approach still fragments the local reports, sort of, in that each local report is attached to a different form instead of being filters of the one national form.

F-Probably not going to be implemented: PROBLEM SOLVED BY MAKING COORDINATORS PART OF LOCAL VOLUNTEER GROUPS AND ADDING IN ISMODULEADMIN VERSUS ISADMIN DISTINCTION IN PERMS THAT AFFECTS HOW SCOPE IS DRAWN IN REPORT WRITING.  add way for groups to have a set scope within which they can report, separate from their default scope (like publishing a reportscope only with no other params, and you can modify the search params without resetting the scope to your default) -- so coords can have admin-like access to reporting on activity logs, but only for logs entered by their local volunteers. IDEA - make locked scopes a hidden field in the forms so they get passed back when new terms are entered, just need to not have the scope box show up on reload, so a flag is needed that perpetuates the hidden scope passing (and keeps the report name in the report box?). - what you really want to do is set the available scopes, have a report that loads some available scopes and nothing else, and those scopes override default scope deriving, and the report name is passed with these scopes so the report name can be in the box up top, and all other entries are made as normal.  Scope returns to default if another report or default view is returned to. -- need to make lock scope a radio button series and not a checkbox.  1 = lock, 2 = limit to selected, but user can choose, 3=default for user.  Then on load of report, option 2 sets showscope and hardwires the available scopes. -- or, is there a way to simply allow a group to have groupscope for reports on a form that has no groupscope for entries?  That would let the coordinators be members of the volunteer group and still view reports?  Have to think on this more...





xoops_version.php:
--changed to make the Block work.
--added reference to new template file.
--added new tables

mysql.sql
--added three columns to form_id to handle the new fields used for new features. (single, group, headers)
--added two new columns to form_id (showviewentries, maxentries)
--added new tables

mymenu.php:
--changed to display items same way as main menu.
--now checks for VIEW permission specifically 

/admin/mailindex.php changed:
--added in three new form params for use in new features: singleentry, groupscope and headerlist
--added two more params, showviewentries, maxentries, and put in a selection for default permissions.
--changed redirect on form creation to the add elements to the form page.
--removed Admin as a default assigned permission
--commented check in update form page that looks for e-mail address

blocks.php and modinfo.php
--Form changed to Forms for menu header.
--modinfo.php: changed to Forms Menu (but this can be changed in XOOPS Block control interface)

/index.php changed:
--form is redisplayed now instead of directing you back to the main page (NOTE THAT RELOADING PAGE RESULTS IN REPOSTING OF DATA)
--message on redirect is changed (see main.php)
--Module name removed from before the form's own name in title of form
--Security added to check for permission before displaying form 
--assign lines added to handle language sent to template
--added switch to go between the "adding" and the "selecting" pages of the module
--added logic to retrieve the entries a user has made in the form, and to display them on a separate page
--added logic to populate ele_values with an existing entry if someone is going to update the entry.
--redirect logic adjusted for editing entries, so it takes you back to the viewing entries page.
--new hidden variable to pass through the viewentry setting (the index number of the entry that you are viewing)
--fixed bug where multiple select boxes weren't remembering more than one entry
--fixed bug where multiple select boxes had the wrong item saved (off by 1)
--added check to clear contents of fields that the user deletes on second viewing
--added in singleentry logic
--added in groupscope logic
--fixed very difficult bug related to multiple and single select boxes needing to be drawn with different value registers (starting with 1 or 0 if single or multiple).  Bug caused single entry boxes to not store information correctly.
--altered how select and checkbox and yes/no information is presented to the user on screen in the view page so it looks nicer.
--added dates to logic for summary list of entries
--security now checks for VIEW permisson specifically
--added logic to handle ADD permission (turn on/off submit button)
--added logic to handle showviewentries setting (turns on/off top nav buttons)
--added logic to handle formlinked select boxes (viewing entries, passing an entry to the form renderer, saving entries from a form)
--added scope control for reports
--added ability save and publish reports
--changed isadmin check to look at form admin perm not module admin perm
--added count-unique to the COUNT calculation
--added ismoduleadmin check which now controls groupscope beyond your own groups.  Regular admins get groupscope on nongroupscope forms
--added export to spreadsheet file
--added proxy user submission feature for admins
--fixed/beefed up the viewentry validity check and now the View entries link is always drawn in the summary list
--users can delete entries (form admin allows all entries to be deleted)
--added sort to idreq array upon creation to fix bug where row metadata (left column) and content got out of whack on view entries page
--commented sending of mail
--rewrote search system

formulaire_select.html
--NEW TEMPLATE for the select page.

formulaire.html
--added "buttons" at the top of the page to switch between adding and selecting
--changed element rows to always use even style, not even/odd.

ele_yn.php
--commented default selection for buttons when no existing default entry exists.

ele_select.php
--added features for a formlinked select box

elementrenderer.php
--constructElement function modified to accept passing of ele_value from index.php (where it is modified to contain existing entries if that is what is required).
--commented code in the handling of Date elements so that dates would be remembered and displayed properly when viewing existing entries.
--Select box drawing altered so that single-entry boxes start at 1, multiple start at 0.  This fixes a bug in the reading of single-entry boxes where the first element would not be read (0 being null was causing NOTHING to be passed back from the form when the first element was selected.
--added formlinked select box handling
--added link scope logic to formlinked select box handling
--changed {NAME} default value for textboxes so that it calls up full name instead of user name.
--changed date handling so that blank and invalid defaults are displayed as blank when the datebox is displayed in a form

admin/formindex.php
--added two new permissions, View and Admin (in addition to regular add/update)
--added permission controls for the scope allowed on linked select boxes
--added confirmation to delete form button


admin/elements.php
--added check that captions are unique to prevent people from entering captions that already exist in a form
--added check for " and \ in captions.
--corrected bug where yes was the default value for yes no buttons even when no default was selected.
--corrected similar bug for regular radio buttons ... not actually corrected, need to check it again
--added handling for saving a formlinked selectbox

main.php for languages altered to add in:
define("_FORMULAIRE_INFO_RECEIVED", "Your information has been received.");
define("_FORMULAIRE_NO_PERMISSION", "You do not have permission to view this form.");
define("_FORMULAIRE_TEMP_ADDENTRY", "ADD AN ENTRY");
define("_FORMULAIRE_TEMP_VIEWENTRIES", "VIEW ENTRIES");
define("_FORMULAIRE_TEMP_ADDINGENTRY", "ADDING AN ENTRY");
define("_FORMULAIRE_TEMP_VIEWINGENTRIES", "VIEWING ENTRIES");
define("_FORMULAIRE_TEMP_SELENTTITLE", "Your entries in '");
define("_FORMULAIRE_TEMP_VIEWTHISENTRY", "View this entry");
define("_FORMULAIRE_TEMP_EDITINGENTRY", "EDITING AN ENTRY");
define("_FORM_SINGLEENTRY","Users can only fill in the form once:");
define("_FORM_GROUPSCOPE","Users can view entries made by everyone in their groups:");
define("_FORMULAIRE_TEMP_SELENTTITLE_GS", "All entries in '");
define("_FORMULAIRE_TEMP_NOENTRIES", "No entries yet.");
define("_FORMULAIRE_TEMP_ENTEREDBY", "Entered by: ");
define("_FORMULAIRE_TEMP_QYES", "YES");
define("_FORMULAIRE_TEMP_QNO", "NO");
//new, put in other langs:
define("_FORMULAIRE_TEMP_ENTEREDBYSINGLE", "Entered ");
define("_FORMULAIRE_TEMP_ON", "on");
define("_AM_FORM_TITLE", "Form Access Permissions"); // define("_AM_FORM_TITLE", "Permissions d\'accès aux formulaires");
define("_AM_FORM_CURPERM", "Current Permission:"); 
define("_AM_FORM_PERMVIEW", "View");
define("_AM_FORM_PERMADD", "Add/Update");
define("_AM_FORM_PERMADMIN", "Admin");
define("_AM_FORM_SUBMITBUTTON", "Show New Permission"); //not used
define("_AM_FORMLINK_PICK", "Choose an option");
plus others??????


admin.php in languages folder:
define("_FORMULAIRE_CAPTION_MATCH", "The caption you entered is already in use. A '2' has been appended to it.");
define("_FORMULAIRE_CAPTION_QUOTES", "Captions cannot have quotes. They have been removed.");
define("_FORMULAIRE_CAPTION_SLASH", "Captions cannot have backslashes. They have been removed.");
//new...
define("_AM_ELE_FORMLINK", "Options linked from another form");
define("_AM_ELE_FORMLINK_DESC","Select a field in another form and use those entries for the options in this Select Box. (This setting overrides any options specified above.)");
define("_AM_FORMLINK_NONE", "No link -- above options in effect");



