<div class="panel-content content">
	<div class="form-item">
		<fieldset>
			<legend>What kind of select box is this?</legend>
			<div class="form-radios">
				<label for="dropdown"><input type="radio" id="dropdown" name="elements_listordd" value="0"<{if $content.listordd eq 0}> checked="checked"<{/if}>/>This is a dropdown box</label>
			</div>
			<div class="form-radios">
				<label for="list" style="vertical-align: bottom;"><input type="radio" style="vertical-align: bottom;" id="list" name="elements_listordd" value="1"<{if $content.listordd eq 1}> checked="checked"<{/if}>/>This is a list box, with <input type="text" id="elements-ele_value_0" name="elements-ele_value[0]" value="<{$content.ele_value[0]}>" maxlength=2 size=2> rows.</label>
				<blockquote style='margin-top: 3px'>
					Multiple selections are:
					<label for="elements_multiple_allowed"><input type="radio" id="elements_multiple_allowed" name="elements_multiple" value="1" <{if $content.multiple}>checked<{/if}>/>Allowed</label>
					<label for="elements_multiple_notallowed"><input type="radio" id="elements_multiple_notallowed" name="elements_multiple" value="0" <{if $content.multiple eq 0}>checked<{/if}>/>Not Allowed</label>
				</blockquote>
			</div>
			<div class="form-radios">
				<label for="autocomplete"><input type="radio" id="autocomplete" name="elements_listordd" value="2"<{if $content.listordd eq 2}> checked="checked"<{/if}>/>This is a "autocompletion" text box, which will give users a list of choices based on what they type in the box</label>
				<blockquote style='margin-top: 3px'>
                    Multiple selections are:
					<label for="elements_multiple_allowed_auto"><input type="radio" id="elements_multiple_allowed_auto" name="elements_multiple_auto" value="1" <{if $content.multiple_auto}>checked<{/if}>/>Allowed</label>
					<label for="elements_multiple_notallowed_auto"><input type="radio" id="elements_multiple_notallowed_auto" name="elements_multiple_auto" value="0" <{if $content.multiple_auto eq 0}>checked<{/if}>/>Not Allowed</label><br />
					When users type something that doesn't match any of the choices:
					<label for="elements-ele_value[16]-0"><input type="radio" id="elements-ele_value[16]-0" name="elements-ele_value[16]" value="0"<{if $content.ele_value[16] eq 0}> checked="checked"<{/if}>/>Say "No Match Found"</label>
					<label for="elements-ele_value[16]-1"><input type="radio" id="elements-ele_value[16]-1" name="elements-ele_value[16]" value="1"<{if $content.ele_value[16] eq 1}> checked="checked"<{/if}>/>Add what they typed to the list of choices</label>
				</blockquote>
			</div>
		</fieldset>
	</div>

	<{include file="db:admin/element_linkedoptionlist.html"}>
        
    <div class="form-item" id='linkedsourcemapping' style='display: none;'>
        <fieldset>
            <legend>When creating a new entry in the linked source form, map other elements to the source form too:</legend>
            <input type='button' name='new-mapping' value='Add 1' /><br /><br />
            <div id='mappingcontainer'>
              <{if $content.linkedSourceMappings|@count > 0}>
                <{foreach from=$content.linkedSourceMappings key=index item=value name=mappings}>
                  <div class="elementmappings" name="<{$index}>">
                  <select id="mappingthisform-<{$index}>" name="mappingthisform[<{$index}>]" size="1">
                    <{html_options options=$content.mappingthisformoptions selected=$value.thisForm}>
                  </select>
                    >>
                  <select id="mappingsourceform-<{$index}>" name="mappingsourceform[<{$index}>]" size="1">
                    <{html_options options=$content.mappingsourceformoptions selected=$value.sourceForm}>
                  </select>
                  <{if $smarty.foreach.mappings.index > 0}>
                  <img class="removeMapping" style="cursor: pointer;" onclick="removeMapping(<{$index}>)" src="../images/editdelete.gif"></img>
                  <{/if}>
                  </div>
                <{/foreach}>
              <{else}>
                  <div class="elementmappings" name="0">
                  <select id="mappingthisform-0" name="mappingthisform[0]" size="1">
                    <{html_options options=$content.mappingthisformoptions}>
                  </select>
                    >>
                  <select id="mappingsourceform-0" name="mappingsourceform[0]" size="1">
                    <{html_options options=$content.mappingsourceformoptions}>
                  </select>
                  </div>
              <{/if}>
            </div>
        </fieldset>
    </div>

    <div class="form-item">
    <fieldset>
		<legend>If the options are linked -- or are {FULLNAMES} or {USERNAMES}</legend>
		<div class="form-item">
		<fieldset>
			<legend>Limit them to values from the groups selected here</legend>
			<select id="element-formlink_scope" name="element_formlink_scope[]" size="10" multiple>
			<{html_options options=$content.formlink_scope_options selected=$content.formlink_scope}>
			</select>
			<br/><br/>
		<fieldset>
			<div class="form-radios">
				<label for="elements-ele_value[4]-0"><input type="radio" id="elements-ele_value[4]-0" name="elements-ele_value[4]" value="0"<{if $content.ele_value[4] eq 0}> checked="checked"<{/if}>/><{$smarty.const._AM_ELE_FORMLINK_SCOPELIMIT_NO}></label>
			</div>
			<div class="form-radios"><label for="elements-ele_value[4]-1"><input type="radio" id="elements-ele_value[4]-1" name="elements-ele_value[4]" value="1"<{if $content.ele_value[4] eq 1}> checked="checked"<{/if}>/><{$smarty.const._AM_ELE_FORMLINK_SCOPELIMIT_YES}></label></div>
		</fieldset>
		<fieldset>
			<div class="form-radios">
				<label for="elements-ele_value[6]-0"><input type="radio" id="elements-ele_value[6]-0" name="elements-ele_value[6]" value="0"<{if $content.ele_value[6] eq 0}> checked="checked"<{/if}>/><{$smarty.const._AM_ELE_FORMLINK_ANYALL_ANY}></label>
			</div>
			<div class="form-radios">
				<label for="elements-ele_value[6]-1"><input type="radio" id="elements-ele_value[6]-1" name="elements-ele_value[6]" value="1"<{if $content.ele_value[6] eq 1}> checked="checked"<{/if}>/><{$smarty.const._AM_ELE_FORMLINK_ANYALL_ALL}></label>
			</div>
		</fieldset>
            <fieldset>
                <div class="form-select" id="optionsLimitByElementFilterDiv">
                    Further limit the options to values that are selected in this other element: <{$content.optionsLimitByElement}><br /><br />
                    <{if $content.optionsLimitByElementFilter}>
                    <{$content.optionsLimitByElementFilter}><br />
                    <div class="description">Use the filter options to isolate a specific entry in the other form. Dynamic { } references are possible for referring to the values of elements in this form.</div>
                    <{else}>
                    <div class="description">Select an element and then save, to get filter options for isolating a single entry in the selected form.</div>    
                    <{/if}>
                </div>
            </fieldset>
		<div class="description">
			<{$smarty.const._AM_ELE_FORMLINK_SCOPE_DESC}>
		</div>
		</fieldset>
	</div>
    </fieldset>
</div>
        
        <{include file="db:admin/element_linkedfilter.html"}>
        
        <{include file="db:admin/element_linkedsortoptions.html"}>
        
		  <div class="form-item">
		    <fieldset>
			    <legend>Show as links in lists of entries?</legend>
	          <div class="form-radios">
		          <label for="elements-ele_value[7]-1"><input type="radio" id="elements-ele_value[7]-1" name="elements-ele_value[7]" value="1" <{if $content.ele_value[7] eq 1}>checked<{/if}>/>Yes, make these values clickable in lists of entries so people can go to the source form easily</label>
	          </div>
	          <div class="form-radios">
              <label for="elements-ele_value[7]-0"><input type="radio" id="elements-ele_value[7]-0" name="elements-ele_value[7]" value="0" <{if $content.ele_value[7] eq 0}>checked<{/if}>/>No, just show the selected value as text</label>
	          </div>
			    <div class="description">
			    </div>
		    </fieldset>
	    </div>

	<div class="form-item">
	  <fieldset>
		  <legend>Are there restrictions on how many times each option can be picked?</legend>
	        <div class="form-radios">
            <label for="elements-ele_value[9]-0"><input type="radio" id="elements-ele_value[9]-0" name="elements-ele_value[9]" value="0" <{if $content.ele_value[9] eq 0}>checked<{/if}>/>No</label>
	        </div>
	        <div class="form-radios">
		        <label for="elements-ele_value[9]-1"><input type="radio" id="elements-ele_value[9]-1" name="elements-ele_value[9]" value="1" <{if $content.ele_value[9] eq 1}>checked<{/if}>/>Each option can only be chosen once</label>
	        </div>
	        <div class="form-radios">
            <label for="elements-ele_value[9]-2"><input type="radio" id="elements-ele_value[9]-2" name="elements-ele_value[9]" value="2" <{if $content.ele_value[9] eq 2}>checked<{/if}>/>Each option can only be chosen once, per user</label>
	        </div>
	        <div class="form-radios">
            <label for="elements-ele_value[9]-3"><input type="radio" id="elements-ele_value[9]-3" name="elements-ele_value[9]" value="3" <{if $content.ele_value[9] eq 3}>checked<{/if}>/>Each option can only be chosen once, per group</label>
	        </div>
			  <div class="description">
			  </div>
	  </fieldset>
	</div>

	    <div class="form-item">
		    <fieldset>
			    <legend>Which option(s) should be selected by default?</legend>
				<select name=elements-ele_value[13][] size=10 multiple class="form-multiple-select">
					<{foreach from=$content.optionDefaultSelection key="default_entry_id" item="default_value"}>
						<option value=<{$default_entry_id}><{if in_array($default_entry_id, $content.optionDefaultSelectionDefaults)}> selected<{/if}>><{$default_value}></option>
					<{/foreach}>
				</select>
				<div class="form-radios">
			          <label for="elements-ele_value[14]-0"><input type="radio" id="elements-ele_value[14]-0" name="elements-ele_value[14]" value="0" <{if $content.ele_value[14] eq 0}>checked<{/if}>/>Use these defaults the first time the form is shown (when creating a new entry).</label>
				</div>
				<div class="form-radios">
				  <label for="elements-ele_value[14]-1"><input type="radio" id="elements-ele_value[14]-1" name="elements-ele_value[14]" value="1" <{if $content.ele_value[14] eq 1}>checked<{/if}>/>Use these defaults the first time the form is shown, and also when editing an entry that has no value for this linked selectbox.</label>
				</div>
				<div class="description">
					If you use these defaults every time an entry has no value for this linked selectbox, then if a user purposely saves an entry with no values selected, this selectbox will have the defaults showing on screen when the user edits their entry.  So they will always have to un-select the defaults in order to preserve their "no value" choice.
				</div>
		    </fieldset>
	    </div>

		<div class="form-item">
			<fieldset>
				<legend>When displying this element as a list box, display these values:</legend>
				<{$content.displayElements}>
				<div class="description">
				This feature is useful to display multiple elements from the linked form.
				</div>
			</fieldset>
		</div>

	    <div class="form-item">
		    <fieldset>
			    <legend>When displaying this element in a list of entries, or including it in a dataset with the API, use values from a different element in the source form:</legend>
			    <{$content.listValue}>
			    <div class="description">
				This feature is useful if you want the value used in the list of entries to be different from the value that users choose when filling in the form.  For example, you might link to a form called "Master List of Workshops" and in that form there are two fields, the name of the workshop, and a code number that is used to refer to them.  You might link the element to the name of the workshop, to get a list of workshops for users to choose from.  But in a list of entries, you want the code number for the workshop to be displayed.  In that case, you would pick the code number element here.
			    </div>
		    </fieldset>
	    </div>

	    <div class="form-item" style="margin-bottom: 0px">
		    <fieldset>
			    <legend>When exporting this element to a spreadsheet, use values from a different element in the source form:</legend>
			    <{$content.exportValue}>
			    <div class="description">
				This feature is essentially the same as the previous one, except it applies only when data is being exported to a spreadsheet, not when lists of entries are displayed on screen.
			    </div>
		    </fieldset>
	    </div>

</div>

<script type="text/javascript">
    
  $("[name='new-mapping']").click(function (){
    number = $(".elementmappings:last").attr('name');
    number = parseInt(number) + 1;
    $('#mappingcontainer').append('<div class="elementmappings" name="'+number+'"><select id="mappingthisform-'+number+'" name="mappingthisform['+number+']" size="1"></select> >> <select id="mappingsourceform-'+number+'" name="mappingsourceform['+number+']" size="1"></select> <img class="removeMapping" style="cursor: pointer;" onclick="removeMapping('+number+')" src="../images/editdelete.gif"></img></div>');
    var thisformoptions = $('#mappingthisform-0 > option').clone();
    $('#mappingthisform-'+number).append(thisformoptions);
    $('#mappingthisform-'+number+' option:selected').removeAttr('selected');
    var sourceformoptions = $('#mappingsourceform-0 > option').clone();
    $('#mappingsourceform-'+number).append(sourceformoptions);
    $('#mappingsourceform-'+number+' option:selected').removeAttr('selected');
    $("[name='new-mapping']").blur();
    setDisplay('savewarning','block');
  });
    
    function removeMapping(number) {
        $('.elementmappings').remove('[name="'+number+'"]');
        setDisplay('savewarning','block');
    }
    
 $("#elements-ele_value_0").focus(function() {
	  $("#list").attr('checked',1);
 });

 $("[name=elements_multiple]").click(function() {
	$("#list").attr('checked',1);
 });

 $("#elements_multiple_notallowed").click( function(){
 	alert("WARNING: You may lose data when changing the multiple selection of your select box!");
 });

 $("#formlink").change(function() {
		$("#yes").attr('checked',1);
		$("[name=reload_option_page]").val(1);
		$("#filterdiv").empty();
		$("#filterdiv").append('<p><input type="button" class="formButton" name="refreshfilter" onclick="refreshfilterjq()" value="Save changes to update filter options"></p>');
 });

 function refreshfilterjq() {
	 $("[name=reload_option_page]").val(1);
	 $(".savebutton").click();

 }

 $("[name=addoption]").click(function () {
		$("#no").attr('checked',1);
 })

 $("[name=ele_value[0]]").keydown(function () {
	$("#no").attr('checked',1);
	$("#formlink").val('none');
	$("#filterdiv").empty();
	$("#filterdiv").append('<p>The options are not linked.</p>');

 });

    $("div#optionsLimitByElementFilterDiv > a.conditionsdelete").click(function () {
		$(".optionsLimitByElementFilterDelete").val($(this).attr('target'));
		$("[name=reload_option_page]").val(1);
	  $(".savebutton").click();
		return false;
	});
 
 	$("div#optionsLimitByElementFilterDiv > input#addcon").click(function () {
		$("[name=reload_option_page]").val(1);
	  $(".savebutton").click();
		return false;
	});
 
 
    function showHideLinkedSourceMapping() {
        if ($('[name="elements_listordd"]:checked').val()==2 && $('[name="elements-ele_value\\[16\\]"]:checked').val() == 1 && $('#formlink').val() != 'none') {
            if($('#linkedsourcemapping').css('display') == 'none') {
                $('#linkedsourcemapping').css('display', 'block');
            }
            return false;
        } else {
            if($('#linkedsourcemapping').css('display') == 'none') {
		return false;
            }
            $('#linkedsourcemapping').css('display', 'none');
        }
    }
    
    $(document).ready(function() {
        showHideLinkedSourceMapping();
        
        $('[name="elements_listordd"]').change(function() {
            showHideLinkedSourceMapping();
        });
        
        $('[name="elements-ele_value\\[16\\]"]').change(function() {
            showHideLinkedSourceMapping();
        });
        
        $('#formlink').change(function() {
            showHideLinkedSourceMapping();
	});


	});

</script>
