<script type="text/javascript">

	$(function() {
		<{if isset($tabs.1.url)}>
		// URL-based tabs navigation (for home tabs)
		// Find which tab is active
		var activeTabIndex = 0;
		<{foreach from=$tabs key=number item=tab}>
		<{if isset($tab.active) AND $tab.active}>
		activeTabIndex = <{$number}> - 1; // Convert to 0-based index
		<{/if}>
		<{/foreach}>

		// Initialize jQuery UI tabs for styling
		// Note: Using jQuery UI 1.8.2 which uses 'select' event instead of 'beforeActivate'
		$("#tabs").tabs({
			selected: activeTabIndex,
			select: function(event, ui) {
				// In jQuery UI 1.8, ui.tab is the anchor element
				var $anchor = $(ui.tab);
				var url = $anchor.attr('data-url');

				// If this tab has a URL, prevent tab switching and navigate instead
				if (url && url.length > 0) {
					event.preventDefault();
					window.location.href = url;
					return false;
				}
			}
		});
		// Ensure the active tab panel is visible (remove ui-tabs-hide class)
		$("#tabs-" + (activeTabIndex + 1)).removeClass('ui-tabs-hide').show();
		<{else}>
		// Traditional tabs with content switching
		$("#tabs").tabs({
			show: refreshCodemirrors
			<{if isset($adminPage.tabselected) AND  $adminPage.tabselected > 0}>,
			selected: <{$adminPage.tabselected}>
			<{/if}>
		});
		<{/if}>
	});

</script>

<div id="tabs">
	<ul>
		<{foreach from=$tabs key=number item=tab}>
		<li<{if isset($tab.active) AND $tab.active}> class="ui-tabs-selected ui-state-active"<{/if}>>
			<a href="#tabs-<{$number}>"<{if isset($tab.url)}> data-url="<{$tab.url}>"<{/if}>><{$tab.name}></a>
		</li>
		<{/foreach}>
	</ul>
	<{foreach from=$tabs key=number item=tab}>
	<{if isset($tab.url)}>
	<{* URL-based tabs: only render content for the active tab *}>
	<{if isset($tab.active) AND $tab.active}>
	<div id="tabs-<{$number}>" class="tab-content">
		<{include file=$tab.template}>
	</div>
	<{/if}>
	<{else}>
	<{* Traditional tabs - render all content *}>
	<div id="tabs-<{$number}>" class="tab-content">
		<{include file=$tab.template content=$tab.content}>
	</div>
	<{/if}>
	<{/foreach}>
</div><!-- end tabs -->
